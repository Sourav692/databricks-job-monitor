2025-09-02 04:13:16,012 - __main__ - INFO - Starting Databricks job monitoring...
2025-09-02 04:13:16,012 - __main__ - INFO - Running in local environment
2025-09-02 04:13:16,013 - __main__ - INFO - Host: https://e2-demo-west.cloud.databricks.com/
2025-09-02 04:13:16,013 - __main__ - INFO - Warehouse ID: 75fd8278393d07eb
2025-09-02 04:13:17,439 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:17,440 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:17,443 - databricks.sql.client - INFO - Successfully opened session 01f08785-0d5e-1d61-8b22-a4efac73f88b
2025-09-02 04:13:17,443 - src.monitors.system_tables_client - INFO - SQL connection established successfully
2025-09-02 04:13:17,884 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:17,884 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:17,898 - __main__ - INFO - [SUCCESS] Connection test successful!
2025-09-02 04:13:17,898 - __main__ - INFO - Checking for available job data...
2025-09-02 04:13:17,898 - src.monitors.system_tables_client - INFO - Executing query: 
        SELECT 
            workspace_id,
            job_id,
            COUNT(DISTINCT run_id) as...
2025-09-02 04:13:22,885 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:22,885 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:22,947 - src.monitors.system_tables_client - INFO - Query returned 20 rows
2025-09-02 04:13:22,947 - src.monitors.system_tables_client - INFO - Executing query: DESCRIBE system.lakeflow.job_run_timeline...
2025-09-02 04:13:23,760 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:23,760 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:23,763 - src.monitors.system_tables_client - INFO - Query returned 13 rows
2025-09-02 04:13:23,763 - src.monitors.system_tables_client - INFO - Executing query: 
        SELECT 
            DATE(period_start_time) as job_date,
            COUNT(DISTINCT job_id)...
2025-09-02 04:13:28,351 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:28,351 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:28,355 - src.monitors.system_tables_client - INFO - Query returned 8 rows
2025-09-02 04:13:28,355 - __main__ - INFO - Fetching comprehensive job metrics...
2025-09-02 04:13:28,355 - src.monitors.job_monitor - INFO - Fetching job runtime metrics for last 7 days...
2025-09-02 04:13:28,356 - src.monitors.system_tables_client - INFO - Executing query: 
        WITH job_run_duration AS (
            SELECT 
                workspace_id,
              ...
2025-09-02 04:13:33,010 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:33,011 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:34,038 - src.monitors.system_tables_client - INFO - Query returned 3053 rows
2025-09-02 04:13:34,038 - src.monitors.job_monitor - INFO - Analyzing job failures...
2025-09-02 04:13:34,038 - src.monitors.system_tables_client - INFO - Executing query: 
        WITH job_runs AS (
            SELECT DISTINCT
                jrt.workspace_id,
          ...
2025-09-02 04:13:38,560 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:38,560 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:39,473 - src.monitors.system_tables_client - INFO - Query returned 3053 rows
2025-09-02 04:13:39,474 - src.monitors.job_monitor - INFO - Fetching cluster utilization metrics...
2025-09-02 04:13:39,474 - src.monitors.system_tables_client - INFO - Executing query: 
        SELECT 
            cluster_id,
            driver,
            COUNT(*) as data_points,
  ...
2025-09-02 04:13:42,880 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:42,880 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:42,886 - src.monitors.system_tables_client - INFO - Query returned 20 rows
2025-09-02 04:13:42,886 - __main__ - INFO - Generating monitoring report...
2025-09-02 04:13:42,886 - src.monitors.job_monitor - INFO - Fetching job runtime metrics for last 7 days...
2025-09-02 04:13:42,886 - src.monitors.system_tables_client - INFO - Executing query: 
        WITH job_run_duration AS (
            SELECT 
                workspace_id,
              ...
2025-09-02 04:13:47,474 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:47,475 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:48,072 - src.monitors.system_tables_client - INFO - Query returned 3053 rows
2025-09-02 04:13:48,072 - src.monitors.job_monitor - INFO - Analyzing job failures...
2025-09-02 04:13:48,072 - src.monitors.system_tables_client - INFO - Executing query: 
        WITH job_runs AS (
            SELECT DISTINCT
                jrt.workspace_id,
          ...
2025-09-02 04:13:52,633 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:52,633 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:53,224 - src.monitors.system_tables_client - INFO - Query returned 3053 rows
2025-09-02 04:13:53,225 - src.monitors.job_monitor - INFO - Fetching cluster utilization metrics...
2025-09-02 04:13:53,225 - src.monitors.system_tables_client - INFO - Executing query: 
        SELECT 
            cluster_id,
            driver,
            COUNT(*) as data_points,
  ...
2025-09-02 04:13:56,413 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:56,413 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:56,418 - src.monitors.system_tables_client - INFO - Query returned 20 rows
2025-09-02 04:13:56,538 - __main__ - INFO - [SUCCESS] Monitoring report saved to: /Users/sourav.banerjee/Documents/My Codebases/databricks-job-monitor/job_report/job_monitoring_report_20250902_041356.md
2025-09-02 04:13:56,539 - databricks.sql.client - INFO - Closing session 01f08785-0d5e-1d61-8b22-a4efac73f88b
2025-09-02 04:13:56,864 - databricks.sql.auth.retry - INFO - Received status code 200 for POST request
2025-09-02 04:13:56,865 - databricks.sql.auth.thrift_http_client - INFO - HTTP Response with status code 200, message: OK
2025-09-02 04:13:56,865 - src.monitors.system_tables_client - INFO - SQL connection closed
2025-09-02 04:13:56,865 - __main__ - INFO - [SUCCESS] Monitoring completed successfully!
